<!DOCTYPE html>
<!--[if lt IE 7 ]><html class="ie ie6" lang="en"> <![endif]-->
<!--[if IE 7 ]><html class="ie ie7" lang="en"> <![endif]-->
<!--[if IE 8 ]><html class="ie ie8" lang="en"> <![endif]-->
<!--[if (gte IE 9)|!(IE)]><!--><html lang="en"> <!--<![endif]-->
<head>
  <meta charset="utf-8">
  <meta name="google-site-verification" content="VikwqTxe7ybu1qSM7LFgIQpvHLN0_j-iVzaLqF88vEw" />
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>Matt Swanson - A Dangerous Obsession with Primitives</title>
  <meta name="author" content="Matt Swanson" />
  <meta name="description" content="writing on software, book writeups and projects by a software engineer from Indianapolis" />
  
  <link rel="canonical" href="http://mdswanson.com/blog/2012/05/31/primitive-obsession.html" />

  <link href="//fonts.googleapis.com/css?family=Nunito:400,700,300|Varela+Round" rel="stylesheet" type="text/css">

  <link rel="shortcut icon" href="/static/favicon.png">
  <link rel="alternate" type="application/rss+xml" title="Matt Swanson's Blog" href="http://localhost:4000/atom.xml" />

  
    <link rel="stylesheet" href="/css/site.css">
  
</head>
<body>
  <section>
    <header class="navigation">
  <a href="/" class="logo" title="ÄLG, a solitary moose.">
    <img src="/static/moose.png" alt="Moose">
  </a>
  <nav>
    <ul>
      <li><a href="/">writing</a></li>
      <li><a href="/archive">archive</a></li>
      <li><a href="/about">about</a></li>
      <li class="no-bullet"><a href="/atom.xml">rss</a></li>
    </ul>
  </nav>
</header>

<article>
  <h1 class="title">
    A Dangerous Obsession with Primitives
  </h1>

  
  <p class="subtitle">
    
      <span>
        
          Series:
          
            
              <a href="/#growth">growth</a>
            
          
        
      </span>

      <span class="date">
        May 31, 2012
      </span>
    
  </p>

  <div id="post"><p>I recently came across a code smell called <strong>Primitive Obsession</strong> in James Shore’s 
excellent <a href="http://jamesshore.com/Blog/Lets-Play">Let’s Play TDD screencasts</a>.</p>

<p>As programmers, using primitives (i.e. built-in types like int, float, string) are
a security blanket.</p>

<p>Primitives are familiar to us. When we are unsure about a complex domain, we try to distill 
the objects down to dumb “bags of properties”. This allow us to continue working and feel like 
we are making progress — despite not fully grasping the domain.</p>

<p>We also lull ourselves into thinking we are reducing complexity. How many times have you said 
<em>“Oh, the BazBar? It’s just a boolean flag”</em> and shrugged off the domain implications?</p>

<p>As soon as I heard this term, I immediately thought back to a recent project I was on. 
This smell was all over the codebase, staring me right in the face. But I couldn’t articulate
the problem until now.</p>

<p>Part of the application involved entering data about the food you ate. The user would input 
calories, carbs, fat — just like on a nutritional label.</p>

<p>The problem was that we were representing all of the different food metrics with simple integers.
Calories were an <code class="highlighter-rouge">int</code>. Carbs were an <code class="highlighter-rouge">int</code>. Integers <a href="http://en.wikipedia.org/wiki/Turtles_all_the_way_down">all the way down</a>.</p>

<p>At first, this was okay.</p>

<p>But when it came time to address internationalization, we needed 
to introduce the concept of units. For example, in the US we typically measure carbs in grams. 
But in Germany, they use something called Bread Units (BU).</p>

<p>Alarms should have been going off that I needed to change Carbs from an <code class="highlighter-rouge">int</code> to a 
<a href="http://c2.com/cgi/wiki?ValueObject">value object</a>. Alas, I started trying to figure out how to bolt on unit conversions to 
the existing primitive version.</p>

<p>So, naturally, I created a <code class="highlighter-rouge">CarbsUnitConverter</code> with a <code class="highlighter-rouge">convert()</code> method that took an integer and
a conversion factor. More warning flags should have popped up when I had to return a decimal value 
from <code class="highlighter-rouge">convert</code> to handle all the supported units. Not only did I have a Primitive Obsession, but I 
was changing the primitive based on context!</p>

<p>I went along blissfully injecting my <code class="highlighter-rouge">CarbsUnitConverter</code> into every place where we displayed 
carbs in the app. This lead to messy code and exposed the unit conversions to areas of the system
that should not have known or cared about it.</p>

<p>The moral of the story was that having a primitive obsession actually increased the complexity in 
the application by allowing business logic to spill into unrelated classes.</p>

<p>This code smell is fairly easy to identify; the difficulty is having the discipline to prevent it
from creeping into your codebase in the first place.</p>
</div>      

  
    <hr class="fin"/>
  
</article>


  <footer>
  <div id="bio">
    <div id="bio-image">
      <img src="/static/mugshot.jpg" alt="Matt Swanson">
    </div>
    
    <div id="bio-text">
      <p>Hi. I'm <b>Matt Swanson</b>.</p>
      <p>I do things and sometimes write about it here. I'm a Software Engineer from Indiana and I ship code at <a href="http://www.sep.com/">SEP</a>.</p>
      
      <div id="bio-social">
        <strike>Stalk</strike> Follow me:
<div id="social-links">
  <a title="swanson on Github" href="http://github.com/swanson/"><i class="fa fa-github-square"></i></a>
  <a title="swanson on Hacker News" href="http://news.ycombinator.com/user?id=swanson"><i class="fa fa-hacker-news"></i></a>
  <a title="_swanson on Twitter" href="http://twitter.com/_swanson"><i class="fa fa-twitter-square"></i></a>
  <a title="RSS feed" id="rss" href="/atom.xml"><i class="fa fa-rss-square"></i></a>
</div>
      </div>
    </div>
  </div>

  
  <aside>
    <h3>Further reading</h3>
    <ul class="posts">
      
        
        
          
            <li><a href="/blog/2017/03/29/how-to-start-a-peer-group.html">How to start a peer group</a></li>
          
        
          
            <li><a href="/blog/2016/03/14/the-first-winter.html">The First Winter</a></li>
          
        
          
            <li><a href="/blog/2015/10/05/testing-behavior-vs-implementation.html">Testing Behavior vs Implementation</a></li>
          
        
      
    </ul>
  </aside>
  
</footer>

<div id="fine-print">
  <p>
    built with <a href="#">&hearts;</a>, <a href="http://jekyllrb.com/">Jekyll</a>, and <a href="https://github.com/swanson/swanson.github.com">GitHub Pages</a> &mdash; read the <a href="/legal">fine print</a>
  </p>
</div>

  </section>

  
</body>
</html>
